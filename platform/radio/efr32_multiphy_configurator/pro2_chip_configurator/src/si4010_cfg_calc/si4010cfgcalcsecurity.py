'''
Created on August 25, 2013

@author: shyang
'''

__all__ = ["Si4010CfgCalcSecurity"]

class Si4010CfgCalcSecurity(object):
    '''
    classdocs
    '''
    OEM_Key16_Table = [
        [0x63, 0xB4, 0x92, 0xCD, 0x42, 0x20, 0x03, 0xBC, 0x73, 0x29, 0x09, 0xBB, 0xFF, 0x6A, 0xDC, 0x6D],
        [0x63, 0x4B, 0x92, 0xCD, 0x42, 0x20, 0x03, 0xBC, 0x73, 0x29, 0x09, 0xBB, 0xFF, 0x6A, 0xDC, 0x6D],
        [0x63, 0xB4, 0x29, 0xCD, 0x42, 0x20, 0x03, 0xBC, 0x73, 0x29, 0x09, 0xBB, 0xFF, 0x6A, 0xDC, 0x6D],
        [0x63, 0xB4, 0x92, 0xDC, 0x42, 0x20, 0x03, 0xBC, 0x73, 0x29, 0x09, 0xBB, 0xFF, 0x6A, 0xDC, 0x6D],
        [0x63, 0xB4, 0x92, 0xCD, 0x24, 0x20, 0x03, 0xBC, 0x73, 0x29, 0x09, 0xBB, 0xFF, 0x6A, 0xDC, 0x6D],
        [0x63, 0xB4, 0x92, 0xCD, 0x42, 0x02, 0x03, 0xBC, 0x73, 0x29, 0x09, 0xBB, 0xFF, 0x6A, 0xDC, 0x6D],
        [0x63, 0xB4, 0x92, 0xCD, 0x42, 0x20, 0x30, 0xBC, 0x73, 0x29, 0x09, 0xBB, 0xFF, 0x6A, 0xDC, 0x6D],
        [0x63, 0xB4, 0x92, 0xCD, 0x42, 0x20, 0x03, 0xCB, 0x73, 0x29, 0x09, 0xBB, 0xFF, 0x6A, 0xDC, 0x6D],
        ]

    OEM_ID_KEY_Table = [ 0x00000000,
                         0x00000000,
                         0x00000000,
                         0x00000000,
                         0x00000000,
                         0x00000000,
                         0x00000000,
                         0x00000000,
                         0x00000000 ]


    def __init__(self, inputs):
        self.cfg = {}
        self.cfg_PQ_file = {}
        # TODO check
        if inputs.security.OEM_Key == []:
            self.Key16    = self.OEM_Key16_Table[inputs.topLevelSetup.OTPcfgNum]
        else:
            self.Key16    = inputs.security.OEM_Key
        self.cfg['bOEM_Key[16]']         = self.Key16
        self.cfg_PQ_file['bOEM_Key[16]'] = self.Key16

        if inputs.security.OEM_ID_Key == 0:
            self.ID_Key   = self.OEM_ID_KEY_Table[inputs.topLevelSetup.OTPcfgNum]
        else:
            self.ID_Key   = inputs.security.OEM_ID_Key
        self.cfg['lOEM_ID_Key'] = self.ID_Key


    def get_ID_Key(self, index):
        return self.OEM_ID_KEY_Table[index]

    def get_Key16(self, index):
        return self.OEM_Key16_Table[index]

    def get_cfg_data(self):
        return self.cfg



    def dump(self):
        print('    -------------  configuration data  -------------')
        for m in self.cfg:
            print('        {}  =  {}'.format(m, self.cfg[m]))

















































