<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>EmberZNet API Reference: For the PC Host platform: Network Manager</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="customdoxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">EmberZNet API Reference: For the PC Host platform
   &#160;<span id="projectnumber">EmberZNet 6.8.1.0</span>
   </div>
   <div id="projectbrief">For the EFR32 and EM3xx Platforms</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__network__manager.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Network Manager<div class="ingroups"><a class="el" href="group__apputil.html">Application Utilities API Reference</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga53c12a3b586ec555329a846cb04dcdf6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__network__manager.html#ga53c12a3b586ec555329a846cb04dcdf6">NM_WARNING_LIMIT</a>&#160;&#160;&#160;16</td></tr>
<tr class="separator:ga53c12a3b586ec555329a846cb04dcdf6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1a6b597802071bf50a95a26549a27089"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__network__manager.html#ga1a6b597802071bf50a95a26549a27089">NM_WINDOW_SIZE</a>&#160;&#160;&#160;4</td></tr>
<tr class="separator:ga1a6b597802071bf50a95a26549a27089"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga36fda1a229f5004edabe7dabfefaf5e3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__network__manager.html#ga36fda1a229f5004edabe7dabfefaf5e3">NM_CHANNEL_MASK</a>&#160;&#160;&#160;<a class="el" href="group__ember__types.html#ga031dc35ab795a9087a3dcb725c3335b1">EMBER_ALL_802_15_4_CHANNELS_MASK</a></td></tr>
<tr class="separator:ga36fda1a229f5004edabe7dabfefaf5e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab75b9bb33067157fdf357d19677b8f44"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__network__manager.html#gab75b9bb33067157fdf357d19677b8f44">NM_WATCHLIST_SIZE</a>&#160;&#160;&#160;16</td></tr>
<tr class="separator:gab75b9bb33067157fdf357d19677b8f44"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga1a2c4acb9d78630316f0f4f67c4f4c09"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__network__manager.html#ga1a2c4acb9d78630316f0f4f67c4f4c09">nmUtilWarningHandler</a> (void)</td></tr>
<tr class="memdesc:ga1a2c4acb9d78630316f0f4f67c4f4c09"><td class="mdescLeft">&#160;</td><td class="mdescRight">callback called when unsolicited scan reports hit limit. This callback must be implemented by the application. It is called when the number of unsolicited scan reports received within NM_WINDOW_LIMIT minutes reaches NM_WARNING_LIMIT.  <a href="#ga1a2c4acb9d78630316f0f4f67c4f4c09">More...</a><br /></td></tr>
<tr class="separator:ga1a2c4acb9d78630316f0f4f67c4f4c09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8ee2b0844bf87ba989a5a1f6a6e4d7e9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__network__manager.html#ga8ee2b0844bf87ba989a5a1f6a6e4d7e9">nmUtilProcessIncoming</a> (<a class="el" href="structEmberApsFrame.html">EmberApsFrame</a> *apsFrame, uint8_t messageLength, uint8_t *message)</td></tr>
<tr class="memdesc:ga8ee2b0844bf87ba989a5a1f6a6e4d7e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called from the app in emberIncomingMessageHandler. Returns true if and only if the library processed the message.  <a href="#ga8ee2b0844bf87ba989a5a1f6a6e4d7e9">More...</a><br /></td></tr>
<tr class="separator:ga8ee2b0844bf87ba989a5a1f6a6e4d7e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6845372cce6d7ff2b8a04fae7f8adf6d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__status__codes.html#gabdc825a7bb1ce986862f1566accee9aa">EmberStatus</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__network__manager.html#ga6845372cce6d7ff2b8a04fae7f8adf6d">nmUtilChangeChannelRequest</a> (void)</td></tr>
<tr class="separator:ga6845372cce6d7ff2b8a04fae7f8adf6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>The network manager is an optional function of one device in the ZigBee network. Devices on the network send unsolicited ZDO energy scan reports to the network manager when more than 25% of unicasts fail within a rolling window, but no more than once every 15 minutes.</p>
<p>See <a class="el" href="network-manager_8h.html" title="Utilities for use by the ZigBee network manager. See Network Manager for documentation. ">network-manager.h</a> for source code.</p>
<p>The network manager is the coordinator by default but can be changed via emberSetNetworkManagerRequest(). It processes the energy scan reports from the devices on the network, and is responsible for determining if the network should change channels in an attempt to resolve reliability problems that might be caused by RF interference.</p>
<p>Note that EmberZNet networks are quite robust to many interferers such as 802.11 (WiFi), and the presence of interferers does not necessarily degrade application performance or require a channel change. Because changing channels is disruptive to network operation, channel changes should not be done solely because of observed higher noise levels, as the noise may not be causing any problem.</p>
<p>Also note that receipt of unsolicited scan reports is only an indication of unicast failures in the network. These might be caused by RF interference, or for some other reason such as a device failure. In addition, only the application can tell whether the delivery failures caused an actual problem for the application. In general, it is difficult to automatically determine with certainty that network problems are caused by RF interference. Channel changes should therefore be done sparingly and with careful application design.</p>
<p>The stack provides three APIs in include/zigbee-device-stack.h:</p><ul>
<li>emberEnergyScanRequest</li>
<li>emberSetNetworkManagerRequest</li>
<li>emberChannelChangeRequest</li>
</ul>
<p>This library provides some additional functions:</p><ul>
<li>nmUtilProcessIncomingMessage</li>
<li>nmUtilWarningHandler</li>
<li>nmUtilChangeChannelRequest</li>
</ul>
<p>An application implementing network manager functionality using this library should pass all incoming messages to nmUtilProcessIncomingMessage, which will return true if the message was processed as a ZDO energy scan report. The application should not make any calls to emberEnergyScanRequest(), as the library assumes all incoming scan reports are unsolicited and indicate unicast failures.</p>
<p>When NM_WARNING_LIMIT reports have been processed within NM_WINDOW_SIZE minutes, the nmUtilWarningHandler callback, which must be implemented by the application, is invoked. The default values for these parameters are set in <a class="el" href="network-manager_8h.html" title="Utilities for use by the ZigBee network manager. See Network Manager for documentation. ">network-manager.h</a> and may be modified using #defines within the application configuration header.</p>
<p>The application may use the nmUtilWarningHandler callback, along with other application-specific information, to decide if and when to change the channel by calling nmUtilChangeChannelRequest. This function chooses a new channel from the NM_CHANNEL_MASK parameter using information gathered over time.</p>
<p>In the event of a network-wide channel change, it is possible that some devices, especially sleepy end devices, do not receive the broadcast and remain on the old channel. Devices should use the API emberFindAndRejoinNetwork to get back to the right channel.</p>
<p>Two implementations of this library are provided: network-manager.c, and network-manager-lite.c. The former keeps track of the mean and deviation of the energy on each channel and uses these stats to choose the channel to change to. This consumes a fair amount of RAM. The latter takes the simpler (and possibly more effective) approach of just avoiding past bad channels. Application developers are encouraged to use and modify either of these solutions to take into account their own application-specific needs. </p>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ga36fda1a229f5004edabe7dabfefaf5e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga36fda1a229f5004edabe7dabfefaf5e3">&#9670;&nbsp;</a></span>NM_CHANNEL_MASK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NM_CHANNEL_MASK&#160;&#160;&#160;<a class="el" href="group__ember__types.html#ga031dc35ab795a9087a3dcb725c3335b1">EMBER_ALL_802_15_4_CHANNELS_MASK</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ga53c12a3b586ec555329a846cb04dcdf6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga53c12a3b586ec555329a846cb04dcdf6">&#9670;&nbsp;</a></span>NM_WARNING_LIMIT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NM_WARNING_LIMIT&#160;&#160;&#160;16</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="gab75b9bb33067157fdf357d19677b8f44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab75b9bb33067157fdf357d19677b8f44">&#9670;&nbsp;</a></span>NM_WATCHLIST_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NM_WATCHLIST_SIZE&#160;&#160;&#160;16</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ga1a6b597802071bf50a95a26549a27089"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1a6b597802071bf50a95a26549a27089">&#9670;&nbsp;</a></span>NM_WINDOW_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NM_WINDOW_SIZE&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga6845372cce6d7ff2b8a04fae7f8adf6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6845372cce6d7ff2b8a04fae7f8adf6d">&#9670;&nbsp;</a></span>nmUtilChangeChannelRequest()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__status__codes.html#gabdc825a7bb1ce986862f1566accee9aa">EmberStatus</a> nmUtilChangeChannelRequest </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Chooses a new channel and broadcasts a ZDO channel change request. </p>

</div>
</div>
<a id="ga8ee2b0844bf87ba989a5a1f6a6e4d7e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8ee2b0844bf87ba989a5a1f6a6e4d7e9">&#9670;&nbsp;</a></span>nmUtilProcessIncoming()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool nmUtilProcessIncoming </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structEmberApsFrame.html">EmberApsFrame</a> *&#160;</td>
          <td class="paramname"><em>apsFrame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>messageLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called from the app in emberIncomingMessageHandler. Returns true if and only if the library processed the message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">apsFrame</td><td></td></tr>
    <tr><td class="paramname">messageLength</td><td></td></tr>
    <tr><td class="paramname">message</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga1a2c4acb9d78630316f0f4f67c4f4c09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1a2c4acb9d78630316f0f4f67c4f4c09">&#9670;&nbsp;</a></span>nmUtilWarningHandler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void nmUtilWarningHandler </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>callback called when unsolicited scan reports hit limit. This callback must be implemented by the application. It is called when the number of unsolicited scan reports received within NM_WINDOW_LIMIT minutes reaches NM_WARNING_LIMIT. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Sep 10 2020 11:33:59 for EmberZNet API Reference: For the PC Host platform by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
